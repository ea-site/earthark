$it.modal_open=function(n){function o(t){t.width=n.width;t.height=n.height;t.align=n.align;t.button=n.button;t.callback=n.callback;f.call(t)}function f(){var i,n;this.size="77%";$it.SP&&($it.getCookie($it._SF)==""||$it.getCookie($it._SF)=="0")&&(this.width="300",this.size="75%");$(".modal-btn2").html(this.text).css({width:this.width+"px","margin-left":t.widthOffset(this.width),"text-align":this.align,"font-size":this.size});this.add!==!1&&(n=$(".modal-btn2"),n.append(this.add),i={ex1:u(n.find("input:eq(0)").attr("id")),ex2:u(n.find("input:eq(1)").attr("id"))});this.button?$(".modal-btn2").append($('<div class="modal-btn3"><div id="out" class="modal-close modal-close2">'+t._M_CANCEL+'<\/div><div class="modal-btn3 modal-close2"><div id="in" class="modal-close">'+this.button+"<\/div><div>")):$(".modal-btn2").append($('<div class="modal-btn3"><div id="in" class="modal-close">'+t._M_CLOSE+"<\/div><\/div>"));$(".modal-btn2").css({"margin-top":t.heightOffset($(".modal-btn2").height())});e($("#modal-body")[0]);e($("#modal-main")[0]);$("#in, #out, #modal-body").on({click:function(n){n.preventDefault();n.stopPropagation();var t=Object.prototype.toString.call(n.data.call).slice(8,-1),i=$(this).attr("id");if(n.data.button&&i==="in"&&t=="Function"){if($(".modal-btn1, .modal-btn2").remove(),typeof n.data.add=="object"&&t==="Function"){n.data.call(n.data.add.ex1.checked,n.data.add.ex2.checked);return}}else if($(".modal-btn1, .modal-btn2").fadeOut(500,function(){$(this).remove()}),n.data.button&&(i==="out"||i==="modal-body"))return;t==="Function"&&n.data.call()}},{call:this.callback,button:this.button,add:i})}function s(){$(".modal-btn2").html(t._M_ERROR).append($("<span>",{on:{click:function(){return location.reload(),!1}},text:t._M_RELOAD,css:{"text-decoration":"underline",color:"#0044FF"}})).append('<span id="rerror"><\/span>').css({"font-size":"77%","margin-top":t.heightOffset($(".modal-btn2").height()),"margin-left":t.widthOffset($(".modal-btn2").width())});var n=5,i=setInterval(function(){$(".modal-btn2 #rerror").html("&nbsp;..."+n);--n<0&&($(".modal-btn1, .modal-btn2").remove(),clearInterval(i))},1e3);return!1}function e(n){for(var i=["contextmenu","selectstart","dragdrop","drag","drapStart","dragend","copy","cut","past","mouseup","mouseout"],t;t=i.shift();)$it.addListener(n,t,function(n){var t=n||window.event,i=n.target||event.srcElement;return $it.MSIE?(t.cancelBubble=!0,t.returnValue=!0,!1):(t.stopPropagation(),t.preventDefault(),window.getSelection().removeAllRanges(),!1)})}var u=$it.$id,t={widthOffset:function(n){return Math.round(-(n/2)+(document.body.scrollLeft||document.documentElement.scrollLeft))},heightOffset:function(n){return Math.round(-(n/2)+(document.body.scrollTop||document.documentElement.scrollTop))},innerWidth:Math.round(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth),innerHeight:Math.round(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight),_M_CLOSE:"閉じる Ｘ",_M_CANCEL:"キャンセル",_M_ERROR:"[エラー]リトライ失敗: ",_M_RELOAD:"ページ再読込 ",_M_RETRY:"[エラー]: 読み込みできません",css:{body:"position:static; top:0; left:0; right:0; bottom:0",".modal-btn1":"z-index:2147483646; width:100%; height:100%; background-color:#000; position:fixed; top:0; left:0; _position:absolute; _top:expression(document.documentElement && document.documentElement.scrollTop || document.body && body.scrollTop || 0 + 'px'); _left:expression(document.documentElement && document.documentElement.scrollLeft || document.body && body.scrollLeft ||  0 + 'px'); opacity:0.45; -moz-opacity:0.45; filter:alpha(opacity=45);",".modal-btn2":"z-index:2147483647; cursor:default; overflow:auto; position:absolute; top:50%; left:50%; height:auto; padding:0.5em 0.7em; line-height:1.6em; color:#111; background-color:#f2f2f2; --border:1px #AAA solid; border-radius:4px; -webkit-border-radius:4px; box-sizing:border-box; -ms-box-sizing:border-box; -moz-box-sizing:border-box; -webkit-box-sizing:border-box;box-shadow:rgba(53, 50, 150, 0.24) 0px 0px 6px 3px inset;-webkit-box-shadow:rgba(14, 27, 28, 0.33) 0px 0px 3px 3px inset;-moz-box-shadow:rgba(14, 27, 28, 0.33) 0px 0px 3px 3px inset;",".modal-btn3":"text-align:center; margin-top:0.8em",".modal-close":"margin:0 auto; text-align:center; width:6em; font-size:100%; border:1px #aaa solid; background-color:#dadada; border-radius:4px; -webkit-border-radius:4px;",".modal-close2":"margin:0 0 0 1em;float:right",".modal-close:hover":"background-color:#E0B6E6;"}},r,i;for($it.cssSearch(".modal-btn1")==!1&&$it.addCSS(t.css),r=["add","url","width","height","align","button","callback"],i=0;i<r.length;i++)(typeof n[r[i]]=="undefined"||n[r[i]]===null||n[r[i]]==="")&&(n[r[i]]=!1);$("body").append('<div id="modal-body" class="modal-btn1"><\/div>');$("body").append('<div id="modal-main" class="modal-btn2"><\/div>');$(".modal-btn2").append('<div style="text-align:center"><img src="'+$it.path._READING+'">').css({width:n.width+"px","font-size":"70%"});$(".modal-btn2").css({"margin-left":t.widthOffset($(".modal-btn2").width()),"margin-top":t.heightOffset($(".modal-btn2").height())});n.url?$it.readData.call(o,n.url,s):n.text&&f.call(n)};$it.his={_TOGGLE:0,sg:{_JSON_CHECK:!1,_ERRM:["名前が未入力です<br>","本文が未入力です<br>","削除/編集パスワードが未入力です<br>","このページを離れると、入力したデータが削除されます。本当に移動しますか？"],_MAXNUM:3,_DATA:"forum-data",_STATUS:"forum-status",_NAME:"forum-name",_TIME:"forum-time",_THREAD:"forum-thread",_CONTENT:"forum-content",_POSITION:"forum-position",_LENGTH:"forum-length"},sgLength:function(){var n=$it.$storage.nget(this.sg._LENGTH);return parseInt(n==null?n="0":n,10)},sgRead:function(n){return this.sg._JSON_CHECK?JSON.parse($it.$storage.nget(this.sg._DATA+n)):{status:$it.$storage.nget(this.sg._STATUS+n),name:$it.$storage.nget(this.sg._NAME+n),time:$it.$storage.nget(this.sg._TIME+n),thread:$it.$storage.nget(this.sg._THREAD+n),content:$it.$storage.nget(this.sg._CONTENT+n)}},sgClear:function(){for(var n=0;n<parseInt($it.$storage.nget(this.sg._LENGTH),10);n++)this.sg._JSON_CHECK?$it.$storage.nremove(this.sg._DATA+n):($it.$storage.nremove(this.sg._NAME+n),$it.$storage.nremove(this.sg._TIME+n),$it.$storage.nremove(this.sg._THREAD+n),$it.$storage.nremove(this.sg._CONTENT+n)),$it.$storage.nremove(this.sg._STATUS+n);$it.$storage.nremove(this.sg._POSITION);$it.$storage.nremove(this.sg._LENGTH)}};$it.hisRead=function(n,t,i){function u(n,t,i){var r=$it.his,l="",e,o,s,h,c,f;t==0?c=typeof i=="string"?i:"投稿履歴がありません<br>":(r.sg._JSON_CHECK?(f=r.sgRead(i),e=f.name,o=f.time,s=f.content,h=f.thread):(e=r.sgRead(i).name,o=r.sgRead(i).time,s=r.sgRead(i).content,h=r.sgRead(i).thread),l=t>=2?"("+(i+1)+"/"+t+")":"",c="<div style='margin-top:0.4em;'><b>スレッド：<\/b>"+h+"<br><b>Name：<\/b>"+e+"<br><b>Date：<\/b>"+o+"<br><\/div><div style='margin-top:0.4em;'>"+s+"<\/div>");n.append($("<div>",{id:"inhis","class":"hiscss",html:'<h3 style="margin:0.2em 0 0 0;padding:0;text-align:center;"><b>投稿履歴 '+l+'<\/b><\/h3><div class="line"><\/div>'+c+"<br>"}));$(".hiscss").append($("<button>",{title:"履歴を閉じます",text:"閉じる ×","class":"btncss1",click:function(){r._TOGGLE=0;$(".hiscss").remove()}}));t>=2&&$(".hiscss").append($("<button>",{type:"button",title:"次の履歴",text:"次の履歴","class":"btncss1",click:function(){$(".hiscss").remove();++i>=t&&(i=0);u(n,t,i)}}));t>=1&&$(".hiscss").append($("<button>",{title:"履歴を削除します",text:"全履歴削除","class":"btncss1 btncss2",css:{right:n[0].getBoundingClientRect().left+4+"px"},click:function(){return $it.modal_open({url:null,text:"本当に削除しますか？",width:240,height:0,align:"center",button:"削除",callback:function(){$(".hiscss").remove();r.sgClear();u(n,0,"投稿履歴を削除しました<br>")}}),!1}}))}var r=$it.his;r._TOGGLE=0;n.click(function(){(r._TOGGLE^=1)?(typeof i=="function"&&i(),u(t,r.sgLength(),0)):t.find("div:eq(0)").remove()})}